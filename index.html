<html><head><base href="/" />
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Modern Chat Interface</title>
<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.css">
<style>
:root {
  --primary: #36393f;
  --secondary: #2f3136;
  --accent: #5865f2;
  --text: #dcddde;
  --text-muted: #72767d;
  --message-hover: #32353b;
  --input-bg: #40444b;
  --scrollbar-thumb: #202225;
  --scrollbar-track: #2e3338;
  --timestamp: #a3a6aa;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: 'gg sans', 'Helvetica Neue', Helvetica, Arial, sans-serif;
  background: var(--secondary);
  color: var(--text);
  display: flex;
  flex-direction: column;
  overflow: hidden;
}

.page-wrapper {
  display: flex;
  justify-content: center;
  width: 100%;
  height: 100vh;
  background: var(--secondary);
}

.container {
  display: flex;
  flex-direction: column;
  height: 100vh;
  max-width: 1200px;
  width: 100%;
  margin: 0 auto;
}

.header {
  background: var(--secondary);
  padding: 16px;
  border-bottom: 1px solid rgba(255, 255, 255, 0.05);
  display: flex;
  align-items: center;
  gap: 15px;
  flex-wrap: wrap;
}

.ai-select {
  background: var(--input-bg);
  color: var(--text);
  border: none;
  padding: 8px 12px;
  border-radius: 4px;
  font-size: clamp(12px, 2vw, 14px);
  cursor: pointer;
  transition: background 0.2s;
  max-width: 100%;
}

.ai-select:hover {
  background: var(--accent);
}

.chat-container {
  flex: 1;
  background: var(--primary);
  display: flex;
  flex-direction: column;
  position: relative;
  overflow: hidden;
  width: 100%;
}

.messages {
  flex: 1;
  overflow-y: auto;
  padding: clamp(16px, 3vw, 24px) clamp(12px, 2vw, 16px);
  scroll-behavior: smooth;
}

.messages::-webkit-scrollbar {
  width: 8px;
}

.messages::-webkit-scrollbar-track {
  background: var(--scrollbar-track);
}

.messages::-webkit-scrollbar-thumb {
  background: var(--scrollbar-thumb);
  border-radius: 4px;
}

.message-group {
  margin-bottom: clamp(12px, 2vw, 16px);
  padding: 2px clamp(12px, 2vw, 16px);
  transition: background 0.2s;
}

.message-group:hover {
  background: var(--message-hover);
}

.message-header {
  display: flex;
  align-items: baseline;
  margin-bottom: 4px;
  flex-wrap: wrap;
}

.message-author {
  font-size: clamp(14px, 2.5vw, 1rem);
  font-weight: 500;
  margin-right: 8px;
}

.user-author {
  color: #3498db;
}

.ai-author {
  color: #2ecc71;
}

.message-timestamp {
  color: var(--timestamp);
  font-size: clamp(10px, 1.5vw, 0.75rem);
}

.message-content {
  color: var(--text);
  font-size: clamp(14px, 2.5vw, 1rem);
  line-height: 1.375rem;
  white-space: pre-wrap;
  word-wrap: break-word;
}

.message-content pre {
  background: var(--input-bg);
  padding: 12px;
  border-radius: 4px;
  overflow-x: auto;
}

.message-content code {
  background: var(--input-bg);
  padding: 2px 4px;
  border-radius: 3px;
  font-family: 'Consolas', 'Monaco', monospace;
}

.message-content blockquote {
  border-left: 4px solid var(--accent);
  padding-left: 8px;
  margin: 8px 0;
  color: var(--text-muted);
}

.message-content p {
  margin: 8px 0;
}

.message-content ul, 
.message-content ol {
  margin: 8px 0;
  padding-left: 20px;
}

.message-content .katex-display {
  margin: 1em 0;
  overflow-x: auto;
  overflow-y: hidden;
}

.message-content img {
  max-width: 100%;
  height: auto;
  border-radius: 4px;
}

.message-content a {
  color: var(--accent);
  text-decoration: none;
}

.message-content a:hover {
  text-decoration: underline;
}

.input-container {
  background: var(--primary);
  padding: 0 clamp(12px, 2vw, 16px) clamp(16px, 3vw, 24px);
  width: 100%;
}

.input-wrapper {
  background: var(--input-bg);
  border-radius: 8px;
  padding: 0 clamp(12px, 2vw, 16px);
  display: flex;
  align-items: center;
  max-width: 100%;
}

#message-input {
  flex: 1;
  background: transparent;
  border: none;
  color: var(--text);
  font-size: clamp(14px, 2.5vw, 1rem);
  padding: 12px 0;
  max-height: 40vh;
  min-height: 44px;
  resize: none;
  line-height: 1.375rem;
  width: 100%;
}

#message-input:focus {
  outline: none;
}

#message-input::placeholder {
  color: var(--text-muted);
}

#send-button {
  background: transparent;
  border: none;
  color: var(--accent);
  padding: clamp(8px, 1.5vw, 12px);
  cursor: pointer;
  transition: color 0.2s;
  display: flex;
  align-items: center;
  justify-content: center;
}

#send-button:hover {
  color: #7984f5;
}

#send-button svg {
  width: clamp(20px, 4vw, 24px);
  height: clamp(20px, 4vw, 24px);
  fill: currentColor;
}

.typing-indicator {
  padding: clamp(8px, 1.5vw, 12px) clamp(12px, 2vw, 16px);
  color: var(--text-muted);
  font-size: clamp(12px, 2vw, 0.875rem);
  opacity: 0;
  transition: opacity 0.3s;
  display: flex;
  align-items: center;
  gap: 4px;
}

@media screen and (max-width: 768px) {
  .header {
    padding: 12px;
    gap: 10px;
  }
  
  .message-group {
    padding: 2px 12px;
  }
  
  .input-container {
    padding: 0 12px 16px;
  }
}

@media screen and (max-width: 480px) {
  .header {
    padding: 8px;
    gap: 8px;
  }
  
  .ai-select {
    padding: 6px 10px;
    font-size: 12px;
  }
  
  .message-group {
    padding: 2px 8px;
  }
  
  .input-container {
    padding: 0 8px 12px;
  }
}

.typing-indicator .dots {
  display: flex;
  gap: 4px;
}

.dot {
  width: 6px;
  height: 6px;
  background: var(--text-muted);
  border-radius: 50%;
  animation: bounce 1.4s infinite ease-in-out;
}

.dot:nth-child(1) { animation-delay: -0.32s; }
.dot:nth-child(2) { animation-delay: -0.16s; }

@keyframes bounce {
  0%, 80%, 100% { transform: scale(0); }
  40% { transform: scale(1); }
}
</style>
</head>
<body>
  <div class="page-wrapper">
    <div class="container">
      <div class="header">
        <select class="ai-select" id="modelSelect">
          <option value="" disabled>Select AI Model</option>
        </select>
        <h2>Chat</h2>
        <button class="ai-select" id="clearChat">Clear Chat</button>
        <button class="ai-select" id="clearMemory">Clear Memory</button>
      </div>
      
      <div class="chat-container">
        <div class="messages" id="messages">
          <!-- Messages will be inserted here -->
        </div>
        
        <div class="typing-indicator" id="typing-indicator">
          <span>AI is typing</span>
          <div class="dots">
            <div class="dot"></div>
            <div class="dot"></div>
            <div class="dot"></div>
          </div>
        </div>
        
        <div class="input-container">
          <div class="input-wrapper">
            <textarea 
              id="message-input" 
              placeholder="Send a message..."
              rows="1"
            ></textarea>
            <button id="send-button">
              <svg viewBox="0 0 24 24">
                <path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"/>
              </svg>
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

<script>
document.addEventListener('DOMContentLoaded', () => {
  const messagesContainer = document.getElementById('messages');
  const messageInput = document.getElementById('message-input');
  const sendButton = document.getElementById('send-button');
  const modelSelect = document.getElementById('modelSelect');
  const typingIndicator = document.getElementById('typing-indicator');
  const clearChatButton = document.getElementById('clearChat');
  const clearMemoryButton = document.getElementById('clearMemory');

  let conversationHistory = [];

  fetch('https://api.llmplayground.net/v1/models')
    .then(response => response.json())
    .then(data => {
      data.data.forEach(model => {
        const option = document.createElement('option');
        option.value = model.id;
        option.textContent = model.id;
        modelSelect.appendChild(option);
      });
      modelSelect.value = 'llama-3-70b-chat-turbo';
    })
    .catch(error => console.error('Error fetching AI models:', error));

  marked.setOptions({
    breaks: true,
    gfm: true,
    headerIds: false,
    mangle: false,
    sanitize: false,
    silent: true
  });

  function formatTimestamp() {
    const now = new Date();
    const hours = now.getHours().toString().padStart(2, '0');
    const minutes = now.getMinutes().toString().padStart(2, '0');
    return `${hours}:${minutes}`;
  }

  function processContent(content) {
    content = content.replace(/\\\((.*?)\\\)/g, (match, latex) => {
      try {
        return katex.renderToString(latex, {displayMode: false});
      } catch (e) {
        console.error('LaTeX Error:', e);
        return match;
      }
    });
    
    content = content.replace(/\\\[(.*?)\\\]/g, (match, latex) => {
      try {
        return katex.renderToString(latex, {displayMode: true});
      } catch (e) {
        console.error('LaTeX Error:', e);
        return match;
      }
    });

    try {
      return marked.parse(content);
    } catch (e) {
      console.error('Markdown Error:', e);
      return content;
    }
  }

  function addMessage(content, isUser = false) {
    const messageGroup = document.createElement('div');
    messageGroup.className = 'message-group';

    const messageHeader = document.createElement('div');
    messageHeader.className = 'message-header';

    const author = document.createElement('span');
    author.className = `message-author ${isUser ? 'user-author' : 'ai-author'}`;
    author.textContent = isUser ? 'You' : 'AI';

    const timestamp = document.createElement('span');
    timestamp.className = 'message-timestamp';
    timestamp.textContent = formatTimestamp();

    const messageContent = document.createElement('div');
    messageContent.className = 'message-content';
    messageContent.innerHTML = processContent(content);

    messageHeader.appendChild(author);
    messageHeader.appendChild(timestamp);
    messageGroup.appendChild(messageHeader);
    messageGroup.appendChild(messageContent);
    messagesContainer.appendChild(messageGroup);
    messagesContainer.scrollTop = messagesContainer.scrollHeight;
  }

  function showTypingIndicator() {
    typingIndicator.style.opacity = '1';
  }

  function hideTypingIndicator() {
    typingIndicator.style.opacity = '0';
  }

  async function sendMessageToAI(message) {
    const model = modelSelect.value || 'llama-3-70b-chat-turbo';
    
    try {
      const response = await fetch('https://api.llmplayground.net/v1/chat/completions', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          model: model,
          messages: [
            { role: 'system', content: 'You are a helpful AI assistant.' },
            ...conversationHistory,
            { role: 'user', content: message }
          ],
          max_tokens: 2048,
          temperature: 0.7,
        }),
      });

      const data = await response.json();
      return data.choices[0].message.content;
    } catch (error) {
      console.error('Error:', error);
      return 'Sorry, I encountered an error while processing your request.';
    }
  }

  async function handleUserMessage() {
    const message = messageInput.value.trim();
    if (!message) return;

    addMessage(message, true);
    messageInput.value = '';
    messageInput.style.height = 'auto';
    
    conversationHistory.push({role: 'user', content: message});

    showTypingIndicator();
    const aiResponse = await sendMessageToAI(message);
    hideTypingIndicator();

    addMessage(aiResponse, false);
    conversationHistory.push({role: 'assistant', content: aiResponse});
  }

  function clearChat() {
    messagesContainer.innerHTML = '';
    addMessage("Chat cleared. How can I help you?", false);
  }

  function clearMemory() {
    conversationHistory = [];
    addMessage("Memory cleared. Starting fresh conversation.", false);
  }

  sendButton.addEventListener('click', handleUserMessage);
  
  messageInput.addEventListener('keypress', (e) => {
    if (e.key === 'Enter' && !e.shiftKey) {
      e.preventDefault();
      handleUserMessage();
    }
  });

  messageInput.addEventListener('input', () => {
    messageInput.style.height = 'auto';
    messageInput.style.height = Math.min(messageInput.scrollHeight, 400) + 'px';
  });

  clearChatButton.addEventListener('click', clearChat);
  clearMemoryButton.addEventListener('click', clearMemory);

  addMessage("Hello! I'm your AI assistant. How can I help you today?", false);
});
</script>
</body></html>
